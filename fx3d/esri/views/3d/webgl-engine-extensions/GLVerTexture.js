/**
 * Copyright @ 2021 Esri.
 * All rights reserved under the copyright laws of the United States and applicable international laws, treaties, and conventions.
 */
define(["dojo/_base/declare","../support/fx3dUtils"],function(t,e){var i=0,s=t(null,{declaredClass:"esri.views.3d.webgl-engine-extensions.GLVerTexture",constructor:function(t){this.id=i++,this._gl=t,this._ready=!1,this._pixelData=null,this._pixelDataType=null,this._textureHandle=null},_initParams:function(){this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),this._gl.texParameteri(3553,10242,33071),this._gl.texParameteri(3553,10243,33071),this._gl.texParameteri(3553,10240,9728),this._gl.texParameteri(3553,10241,9728)},_reset:function(t,i){this._width=t,this._height=i,this._pixelSize=window.parseInt(this._width*this._height*4),this._isPowerOfTwo=e.isPowerOfTwo(t)&&e.isPowerOfTwo(i),this._isPowerOfTwo||(console.warn("Width and height are not power of 2, and the rendering may be incorrect."),console.error("GLVerTexture ERROR 222"))},initTexture:function(t,e,i){if(i instanceof Uint8Array)this._pixelDataType=5121;else{if(!(i instanceof Float32Array))return;this._pixelDataType=5126}return this._reset(t,e),isNaN(this._pixelSize)||this._pixelSize!==i.length?(console.warn("The pixel size is invalid."),void console.error("GLVerTexture ERROR 333")):(this._textureHandle=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._textureHandle),this._gl.texImage2D(3553,0,this._gl.RGBA,this._width,this._height,0,this._gl.RGBA,this._pixelDataType,i),void this._initParams())},setData:function(t,e,i){if(i instanceof Uint8Array)this._pixelDataType=5121;else{if(!(i instanceof Float32Array))return;this._pixelDataType=5126}return this._reset(t,e),isNaN(this._pixelSize)||this._pixelSize!==i.length?(console.warn("The pixel size is invalid."),void console.error("GLVerTexture ERROR 333")):(this._pixelData=i,this._textureHandle=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._textureHandle),this._gl.texImage2D(3553,0,this._gl.RGBA,this._width,this._height,0,this._gl.RGBA,this._pixelDataType,this._pixelData),void this._initParams())},updateTexture:function(t){this._pixelData=t,this._gl.bindTexture(this._gl.TEXTURE_2D,this._textureHandle),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._width,this._height,0,this._gl.RGBA,this._pixelDataType,this._pixelData),this._showError()},syncData:function(t){this._gl.bindTexture(this._gl.TEXTURE_2D,this._textureHandle),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._width,this._height,0,this._gl.RGBA,this._pixelDataType,this._pixelData),this._showError()},_showError:function(){var t=this._gl.getError();0!==t&&console.error("TEX Error ==> "+t)},bind:function(t){return this._textureHandle?("number"==typeof t&&this._gl.activeTexture(33984+t),this._gl.bindTexture(3553,this._textureHandle),void this.syncData()):void console.error("GLVerTexture ERROR 444")},unbind:function(){this._gl.bindTexture(3553,null)},release:function(){this._gl.bindTexture(3553,null)},getTextureHandle:function(){return this._textureHandle},dispose:function(){this._textureHandle.__deleted__=!0,this._gl.deleteTexture(this._textureHandle)}});return s});